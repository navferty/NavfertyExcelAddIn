<h1 id="top" class="zag">Navferty's Excel Add-In</h1>

<img class="illustration" id="imnav" src="images/NavfertyToolsRibbonEn.png" alt="Description of the function"></p>

<p>
    Welcome to the official website of the project. Here you can download installation file. Most activity is on the <a
        href="https://github.com/navferty/NavfertyExcelAddIn">project page on GitHub</a>: issues, source code and
    pull-requests.
</p>

<h2 id='how-to-install' class="zag">How to install</h2>

<p>Download and run <a href="https://deploy.navferty.ru/setup.exe">installation file</a> to have add-in installed for your Excel.</p>

<p>
    If you face with certificate problem, you will need to import the provided certificate on your computer:
    <br />
    open setup.exe's properties, go to Digital signatures tab and import the certificate with Wizard:
</p>
<details>
    <summary>Import certificate wizard</summary>
    <img src="./digital-certificate.jpg" alt="Import certificate wizard" />
</details>
<hr>

<h2>Main functions</h2>

<h3 id="parsenumerics" class="zag">Parse Numerics</h3>
<img class="icons" alt="Parse Numerics icon" src="images/icons/parseNumerics.png">
<p class="dscrptn">Convert numbers stored as text to numeric format.</p>
<details class="more">
    <summary>View screenshots</summary>
    <img src="images/ParseNumerics1.png" alt="Description of the function">
    <img src="images/ParseNumerics2.png" alt="Description of the function">
</details>

<h3 id="replace" class="zag">Replace</h3>
<img class="icons" alt="Replace icon" src="images/icons/replace.png">
<p class="dscrptn">Replace Russian characters in the match table.</p>

<ul class="more">
    <li>
        <h4>With Transliteration</h4>
        <img class="icons" alt="Transliteration icon" src="images/icons/transliterate.png">
        <p class="dscrptn">The entire Russian alphabet is completely changed to English. For example, the letter "Ж"
            will be replaced with "Zh", and the letter "Щ" with "Shch". Based on ICAO Doc <a
                href="https://www.icao.int/publications/Documents/9303_p3_cons_en.pdf">9303</a>.</p>
        <details class="more">
            <summary>View screenshots</summary>
            <img src="images/Transliterate1.png" alt="Description of the function">
            <img src="images/Transliterate2.png" alt="Description of the function">
        </details>
    </li>
    <li>
        <h4>Replace Chars</h4>
        <img class="icons" alt="Replace Chars icon" src="images/icons/replaceChars.png">
        <p class="dscrptn">Only uppercase letters of the alphabets will be replaced, such as: Аа, Вв, Ее, Кк, Мм, Нн,
            Оо, Рр, Сс, Тт, Уу, Хх.</p>
        <details class="more">
            <summary>View screenshots</summary>
            <img src="images/ReplaceChars1.png" alt="Description of the function">
            <img src="images/ReplaceChars2.png" alt="Description of the function">
        </details>
    </li>
</ul>

<h3 id="stringifynumerics" class="zag">Stringify Numerics</h3>
<img class="icons" alt="Stringify Numerics icon" src="images/icons/stringifyNumerics.png">
<p class="dscrptn">
  Rewrites numeric values with the text in languages
  <br>- Russian
  <br>- English
  <br>- French
</p>
<details class="more">
    <summary>View screenshots</summary>
    <img src="images/Stringify1.png" alt="Description of the function">
    <img src="images/Stringify2.png" alt="Description of the function">
</details>

<p><a href="#top">Up</a></p>
<hr>

<h3 id="togglecase" class="zag">Toggle Case</h3>
<img class="icons" alt="Toggle Case icon" src="images/icons/toggleCase.png">
<p class="dscrptn">Case switching for text values in selected cells according to the scheme:<br><code>Abcde -&gt; abcde -&gt;
    ABCDE</code></p>
<details class="more">
    <summary>View screenshots</summary>
    <img src="images/ToggleCase1.png" alt="Description of the function">
    <img src="images/ToggleCase2.png" alt="Description of the function">
    <img src="images/ToggleCase3.png" alt="Description of the function">
    <img src="images/ToggleCase4.png" alt="Description of the function">
</details>

<h3 id="trimspaces" class="zag">Trim Spaces</h3>
<img class="icons" alt="Trim Spaces icon" src="images/icons/trimSpaces.png">
<p class="dscrptn">Clear the text content of the selected cells from unnecessary spaces. Removes repeated spaces and
    line breaks, as well as beginning and ending spaces in cells that have a text format.</p>
<details class="more">
    <summary>View screenshots</summary>
    <img src="images/TrimSpaces1.png" alt="Description of the function">
    <img src="images/TrimSpaces2.png" alt="Description of the function">
</details>

<p><a href="#top">Up</a></p>
<hr>

<h3 id="unprotectworkbook" class="zag">Unprotect Workbook</h3>
<img class="icons" alt="Unprotect Workbook icon" src="images/icons/unprotectWorkbook.png">
<p class="dscrptn">Allows you to unprotect all the pages of an open book as the entire book, remove password, and also
    unlock VBA project (if any) to which the password is set. This feature does not apply to encrypted books.</p>

<h3 id="highlightduplications" class="zag">Highlight Duplications</h3>
<img class="icons" alt="Highlight Duplications icon" src="images/icons/highlightDuplicates.png">
<p class="dscrptn">Sets the color of cells that contain duplicate values in the selected range. Different colors
    correspond to different groups of duplicates.</p>
<details class="more">
    <summary>View a screenshot</summary>
    <img src="images/Duplicates.png" alt="Description of the function">
</details>

<h3 id="unmergecells" class="zag">Unmerge Cells</h3>
<img class="icons" alt="Unmerge Cells icon" src="images/icons/unmergeCells.png">
<p class="dscrptn">Unmerge cells and fill each cell of merge area with initial value.</td>
</p>
<details class="more">
    <summary>View screenshots</summary>
    <img src="images/Unmerge1.png" alt="Description of the function">
    <img src="images/Unmerge2.png" alt="Description of the function">
</details>

<h3 id="findallcellscontainingerrors" class="zag">Find all cells containing errors</h3>
<img class="icons" alt="Find all cells containing errors icon" src="images/icons/findErrors.png">
<p class="dscrptn">Search for all cells in the selected cells that contain calculation errors:<br><br>
    Excel formula errors types:<br>
    <code>#N/A</code><br>
    <code>#NAME?</code><br>
    <code>#DIV/0!</code><br>
    <code>#REF!</code><br>
    <code>#VALUE!</code><br>
    <code>#NUM!</code><br>
    <code>#NULL!</code>
</p>
<details class="more">
    <summary>View a screenshot</summary>
    <img src="images/FindErrorValues.png" alt="Description of the function">
</details>

<h3 id="copyasmarkdown" class="zag">Copy as Markdown</h3>
<img class="icons" alt="Copy as Markdown icon" src="images/icons/markdown.png">
<p class="dscrptn">Contents of selected cells will be copied to clipboard in markdown format.</p>
<details class="more">
    <summary>View a screenshot</summary>
    <img src="images/ExportToMarkdown.png" alt="Description of the function">
</details>

<h3 id="validatevalues" class="zag">Validate Values</h3>
<img class="icons" alt="Validate Values icon" src="images/icons/validation.png">
<p class="dscrptn">
    Check the cell values in the selected range for a specific format.<br><br>Supported format: <br>
    - Number<br>
    - Date<br>
    - TIN of an individual* (12 digits, with two verification digits)<br>
    - TIN of the legal entity* (10 digits, with one verification digit)<br>
    - Text for XML (no &lt; and &gt; characters or other invalid characters for XML content)<br><br>
    <em>* - The correct TIN does not guarantee the existence of an organization or individual who would own this
        INN</em></p>
<details class="more">
    <summary>View a screenshot</summary>
    <img src="images/Validate.png" alt="Description of the function">
</details>

<p><a href="#top">Up</a></p>
<hr>

<h3 id="createsamplexmlbasedonxsd" class="zag">Create Sample XML based on XSD</h3>
<img class="icons" alt="Create Sample XML icon" src="images/icons/createSampleXml.png">
<p class="dscrptn">Select file with an XSD schema and create a sample XML based on that schema.</p>

<div class="more">
    <p>For example, for the diagram below</p>
    <details>
        <summary>XML schema sample - sample.xsd</summary>
        <pre>
            &lt;?xml version="1.0" encoding="UTF-8" ?&gt;
            &lt;xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"&gt;
            
            &lt;xs:element name="shiporder"&gt;
            &lt;xs:complexType&gt;
                &lt;xs:sequence&gt;
                &lt;xs:element name="orderperson" type="xs:string"/&gt;
                &lt;xs:element name="shipto"&gt;
                    &lt;xs:complexType&gt;
                    &lt;xs:sequence&gt;
                        &lt;xs:element name="name" type="xs:string"/&gt;
                        &lt;xs:element name="address" type="xs:string"/&gt;
                        &lt;xs:element name="city" type="xs:string"/&gt;
                        &lt;xs:element name="country" type="xs:string"/&gt;
                    &lt;/xs:sequence&gt;
                    &lt;/xs:complexType&gt;
                &lt;/xs:element&gt;
                &lt;xs:element name="item" maxOccurs="unbounded"&gt;
                    &lt;xs:complexType&gt;
                    &lt;xs:sequence&gt;
                        &lt;xs:element name="title" type="xs:string"/&gt;
                        &lt;xs:element name="note" type="xs:string" minOccurs="0"/&gt;
                        &lt;xs:element name="quantity" type="xs:positiveInteger"/&gt;
                        &lt;xs:element name="price" type="xs:decimal"/&gt;
                    &lt;/xs:sequence&gt;
                    &lt;/xs:complexType&gt;
                &lt;/xs:element&gt;
                &lt;/xs:sequence&gt;
                &lt;xs:attribute name="orderid" type="xs:string" use="required"/&gt;
            &lt;/xs:complexType&gt;
            &lt;/xs:element&gt;
            
            &lt;/xs:schema&gt;
        </pre>
    </details>

    <p>The following xml-file will be generated:</p>

    <details>
        <summary>XML output - <code>sample.xml</code></summary>
        <pre>
            &lt;shiporder xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" orderid="orderid1"&gt;
            &lt;orderperson&gt;orderperson1&lt;/orderperson&gt;
            &lt;shipto&gt;
                &lt;name&gt;name1&lt;/name&gt;
                &lt;address&gt;address1&lt;/address&gt;
                &lt;city&gt;city1&lt;/city&gt;
                &lt;country&gt;country1&lt;/country&gt;
            &lt;/shipto&gt;
            &lt;item&gt;
                &lt;title&gt;title1&lt;/title&gt;
                &lt;note&gt;note1&lt;/note&gt;
                &lt;quantity&gt;1&lt;/quantity&gt;
                &lt;price&gt;1&lt;/price&gt;
            &lt;/item&gt;
            &lt;item&gt;
                &lt;title&gt;title2&lt;/title&gt;
                &lt;note&gt;note2&lt;/note&gt;
                &lt;quantity&gt;79228162514264337593543950335&lt;/quantity&gt;
                &lt;price&gt;-79228162514264337593543950335&lt;/price&gt;
            &lt;/item&gt;
            &lt;item&gt;
                &lt;title&gt;title3&lt;/title&gt;
                &lt;note&gt;note3&lt;/note&gt;
                &lt;quantity&gt;2&lt;/quantity&gt;
                &lt;price&gt;79228162514264337593543950335&lt;/price&gt;
            &lt;/item&gt;
            &lt;item&gt;
                &lt;title&gt;title4&lt;/title&gt;
                &lt;note&gt;note4&lt;/note&gt;
                &lt;quantity&gt;79228162514264337593543950334&lt;/quantity&gt;
                &lt;price&gt;0.9&lt;/price&gt;
            &lt;/item&gt;
            &lt;item&gt;
                &lt;title&gt;title5&lt;/title&gt;
                &lt;note&gt;note5&lt;/note&gt;
                &lt;quantity&gt;3&lt;/quantity&gt;
                &lt;price&gt;1.1&lt;/price&gt;
            &lt;/item&gt;
            &lt;/shiporder&gt;
        </pre>
    </details>
</div>

<h3 id="validatexmlwithxsd" class="zag">Validate XML with XSD</h3>
<img class="icons" alt="Validate XML icon" src="images/icons/validateXml.png">
<p class="dscrptn">Check XML file with XSD schema. Select xml and xsd files, and report with all validation errors and
    warnings will be created in new workbook.</p>
<div class="more">
    <p>Sample error report</p>
    <div class="tbl">
        <table>
            <thead>
                <tr>
                    <th>Severity</th>
                    <th>Element</th>
                    <th>Message</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Error</td>
                    <td>city</td>
                    <td>The element 'shipto' has invalid child element 'city'. List of possible elements expected:
                        'address'.</td>
                </tr>
                <tr>
                    <td>Error</td>
                    <td>quantity</td>
                    <td>
                        The 'quantity' element is invalid - The value '-5' is invalid according to its datatype
                        'http://www.w3.org/2001/XMLSchema:positiveInteger' - Value '-5' was either too large or too
                        small for
                        PositiveInteger.
                    </td>
                </tr>
                <tr>
                    <td>Error</td>
                    <td>price</td>
                    <td>
                        The 'price' element is invalid - The value 'asdasd' is invalid according to its datatype
                        'http://www.w3.org/2001/XMLSchema:decimal' - The string 'не число' is not a valid Decimal value.
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<p><a href="#top">Up</a></p>
<hr>

<h3 id="undolastaction" class="zag">Undo Last Action</h3>
<img class="icons" alt="Undo Last Action icon" src="images/icons/undo.png">
<p class="dscrptn">Undo the last action performed with this add-in. Canceling is possible for some functions in the
    'Converting values' and 'Formatting values' sections, and only if the range of cells was not edited after the action
    was performed.</p>

<p><a href="#top">Up</a></p>
