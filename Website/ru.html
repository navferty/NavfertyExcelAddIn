<h1 id="top" class="zag">Надстройка Navferty Excel Add-In</h1>

<p class="subtitle">
    Бесплатная надстройка для Excel, которая повышает продуктивность инструментами для обработки данных, форматирования и валидации.
</p>

<img class="hero-image" src="images/NavfertyToolsRibbonRu.png" alt="Лента Navferty's Tools в Microsoft Excel">

<div class="hero-actions">
    <a href="https://deploy.navferty.ru/setup.exe" class="btn btn-primary">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M10 13L5 8h3V3h4v5h3l-5 5z" fill="currentColor" />
            <path d="M3 15h14v2H3v-2z" fill="currentColor" />
        </svg>
        Скачать установщик
    </a>
    <a href="https://github.com/navferty/NavfertyExcelAddIn" class="btn btn-secondary" target="_blank" rel="noopener">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M10 0C4.477 0 0 4.477 0 10c0 4.42 2.865 8.17 6.839 9.49.5.092.682-.217.682-.482 0-.237-.008-.866-.013-1.7-2.782.603-3.369-1.34-3.369-1.34-.454-1.156-1.11-1.463-1.11-1.463-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.087 2.91.831.092-.646.35-1.086.636-1.336-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.269 2.75 1.025A9.578 9.578 0 0110 4.836c.85.004 1.705.114 2.504.336 1.909-1.294 2.747-1.025 2.747-1.025.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .267.18.578.688.48C17.137 18.163 20 14.418 20 10c0-5.523-4.477-10-10-10z" fill="currentColor" />
        </svg>
        Открыть на GitHub
    </a>
</div>

<div class="info-box">
    <h3>Что внутри</h3>
    <p>
        Navferty Excel Add-In предоставляет набор инструментов для обработки данных, форматирования и валидации.
        Преобразование текста в числа, транслитерация текста, валидация XML-файлов и многое другое.
    </p>
    <p>
        <strong>100% бесплатно</strong> • <strong>С открытым кодом</strong> • <strong>Активно развивается</strong>
    </p>
</div>

<h2 id='how-to-install' class="zag">Установка</h2>

<div class="installation-steps">
    <div class="step">
        <div class="step-number">1</div>
        <div class="step-content">
            <h4>Скачайте установщик</h4>
            <p>Получите последнюю версию с нашего сервера:</p>
            <a href="https://deploy.navferty.ru/setup.exe" class="btn btn-primary btn-small">Скачать setup.exe</a>
        </div>
    </div>

    <div class="step">
        <div class="step-number">2</div>
        <div class="step-content">
            <h4>Запустите установку</h4>
            <p>Дважды щёлкните по загруженному файлу <code>setup.exe</code> и следуйте инструкциям мастера установки.</p>
        </div>
    </div>

    <div class="step">
        <div class="step-number">3</div>
        <div class="step-content">
            <h4>Перезапустите Excel</h4>
            <p>Если Excel был открыт во время установки, перезапустите его. Вы увидите новую вкладку <strong>Navferty's Tools</strong> на ленте.</p>
        </div>
    </div>
</div>

<details>
    <summary>Установка сертификата (если требуется)</summary>
    <div class="warning-box">
        <p>Если возникает предупреждение о сертификате:</p>
        <ol>
            <li>Щёлкните правой кнопкой мыши по файлу <code>setup.exe</code> и выберите <strong>Свойства</strong></li>
            <li>Перейдите на вкладку <strong>Цифровые подписи</strong></li>
            <li>Выберите подпись и нажмите <strong>Сведения</strong></li>
            <li>Нажмите <strong>Просмотреть сертификат</strong> → <strong>Установить сертификат</strong></li>
            <li>Выберите <strong>Локальный компьютер</strong> и поместите его в <strong>Доверенные корневые центры сертификации</strong></li>
        </ol>
        <img src="./cert-install.png" alt="Мастер импорта сертификатов">
        <p><em>Примечание: Вы можете удалить сертификат после установки, но он потребуется для будущих обновлений.</em></p>
    </div>
</details>

<h2 id='how-to-uninstall' class="zag">Удаление</h2>

<p><strong>Способ 1: Параметры Windows (рекомендуется)</strong></p>
<ol>
    <li>Откройте Параметры Windows (<kbd>Win</kbd> + <kbd>I</kbd>)</li>
    <li>Перейдите в <strong>Приложения</strong> → <strong>Приложения и возможности</strong> (или <strong>Установленные приложения</strong> в Windows 11)</li>
    <li>Найдите <strong>Navferty Excel Add-In</strong> в списке</li>
    <li>Нажмите <strong>Удалить</strong> и следуйте инструкциям</li>
</ol>

<p><strong>Способ 2: Панель управления</strong></p>
<ol>
    <li>Откройте <strong>Панель управления</strong></li>
    <li>Перейдите в <strong>Программы</strong> → <strong>Программы и компоненты</strong></li>
    <li>Щёлкните правой кнопкой мыши по <strong>Navferty Excel Add-In</strong> и выберите <strong>Удалить</strong></li>
</ol>

<hr>

<h2 id="features">Обзор функций</h2>

<p class="section-intro">Инструменты для повышения продуктивности работы в Excel</p>

<h3 id="parsenumerics" class="zag">
    <img class="icons" alt="Иконка Парсинг чисел" src="images/icons/parseNumerics.png">
    Парсинг чисел
</h3>
<p class="dscrptn">Преобразование чисел, сохранённых как текст, в правильный числовой формат для использования в вычислениях.</p>
<details class="more">
    <summary>Посмотреть скриншоты</summary>
    <img src="images/ParseNumerics1.png" alt="Парсинг чисел - До">
    <img src="images/ParseNumerics2.png" alt="Парсинг чисел - После">
</details>

<h3 id="replace" class="zag">
    <img class="icons" alt="Иконка Заменить" src="images/icons/replace.png">
    Заменить
</h3>
<p class="dscrptn">Замена русских символов различными методами преобразования.</p>

<ul class="more">
    <li>
        <h4 id="withtransliteration" class="zag">
            <img class="icons" alt="Иконка Транслитерации" src="images/icons/transliterate.png">
            Транслитерацией
        </h4>
        <p class="dscrptn">
            Полная транслитерация русского алфавита на английский. Например: "Ж" → "Zh", "Щ" → "Shch".
            Основано на документе ИКАО <a href="https://www2023.icao.int/publications/Documents/9303_p3_cons_ru.pdf" target="_blank" rel="noopener">Doc 9303</a>.
        </p>
        <details class="more">
            <summary>Посмотреть скриншоты</summary>
            <img src="images/Transliterate1.png" alt="Транслитерация - До">
            <img src="images/Transliterate2.png" alt="Транслитерация - После">
        </details>
    </li>
    <li>
        <h4 id="replacechars" class="zag">
            <img class="icons" alt="Иконка Замены на аналоги" src="images/icons/replaceChars.png">
            На аналоги
        </h4>
        <p class="dscrptn">
            Замена только визуально схожих букв: А↔A, В↔B, Е↔E, К↔K, М↔M, Н↔H, О↔O, Р↔P, С↔C, Т↔T, У↔Y, Х↔X.
        </p>
        <details class="more">
            <summary>Посмотреть скриншоты</summary>
            <img src="images/ReplaceChars1.png" alt="Замена на аналоги - До">
            <img src="images/ReplaceChars2.png" alt="Замена на аналоги - После">
        </details>
    </li>
</ul>

<h3 id="stringifynumerics" class="zag">
    <img class="icons" alt="Иконка Преобразовать числа в слова" src="images/icons/stringifyNumerics.png">
    Преобразовать числа в слова
</h3>
<p class="dscrptn">Преобразование чисел в текстовое представление на разных языках:</p>
<ul>
    <li>Русский</li>
    <li>Английский</li>
    <li>Французский</li>
</ul>
<details class="more">
    <summary>Посмотреть скриншоты</summary>
    <img src="images/Stringify1.png" alt="Преобразование чисел - Ввод">
    <img src="images/Stringify2.png" alt="Преобразование чисел - Результат">
</details>

<p class="back-to-top"><a href="#top">↑ Наверх</a></p>

<hr>

<h3 id="togglecase" class="zag">
    <img class="icons" alt="Иконка Изменить регистр" src="images/icons/toggleCase.png">
    Изменить регистр
</h3>
<p class="dscrptn">Циклическое переключение регистра текста: <code>Абвгд</code> → <code>абвгд</code> → <code>АБВГД</code></p>
<details class="more">
    <summary>Посмотреть скриншоты</summary>
    <img src="images/ToggleCase1.png" alt="Изменить регистр - Пример 1">
    <img src="images/ToggleCase2.png" alt="Изменить регистр - Пример 2">
    <img src="images/ToggleCase3.png" alt="Изменить регистр - Пример 3">
    <img src="images/ToggleCase4.png" alt="Изменить регистр - Пример 4">
</details>

<h3 id="trimspaces" class="zag">
    <img class="icons" alt="Иконка Удалить пробелы" src="images/icons/trimSpaces.png">
    Удалить пробелы
</h3>
<p class="dscrptn">Удаление лишних пробелов, переносов строк и начальных/конечных пробелов из текстовых ячеек.</p>
<details class="more">
    <summary>Посмотреть скриншоты</summary>
    <img src="images/TrimSpaces1.png" alt="Удалить пробелы - До">
    <img src="images/TrimSpaces2.png" alt="Удалить пробелы - После">
</details>

<p class="back-to-top"><a href="#top">↑ Наверх</a></p>

<hr>

<h3 id="unprotectworkbook" class="zag">
    <img class="icons" alt="Иконка Снять защиту" src="images/icons/unprotectWorkbook.png">
    Снять защиту с книги
</h3>
<p class="dscrptn">Снятие защиты со всех листов, структуры книги и VBA-проектов без необходимости паролей. <em>Примечание: Не работает с зашифрованными книгами.</em></p>

<h3 id="highlightduplications" class="zag">
    <img class="icons" alt="Иконка Подсветить дубликаты" src="images/icons/highlightDuplicates.png">
    Подсветить дубликаты
</h3>
<p class="dscrptn">Автоматическая цветовая кодировка повторяющихся значений в выбранном диапазоне. Разные цвета обозначают разные группы дубликатов.</p>
<details class="more">
    <summary>Посмотреть скриншот</summary>
    <img src="images/Duplicates.png" alt="Подсвеченные дубликаты разными цветами">
</details>

<h3 id="unmergecells" class="zag">
    <img class="icons" alt="Иконка Разъединить ячейки" src="images/icons/unmergeCells.png">
    Разъединить ячейки
</h3>
<p class="dscrptn">Разъединение ячеек с заполнением каждой ячейки исходным объединённым значением.</p>
<details class="more">
    <summary>Посмотреть скриншоты</summary>
    <img src="images/Unmerge1.png" alt="Разъединить ячейки - До">
    <img src="images/Unmerge2.png" alt="Разъединить ячейки - После">
</details>

<h3 id="findallcellscontainingerrors" class="zag">
    <img class="icons" alt="Иконка Найти все ошибки" src="images/icons/findErrors.png">
    Найти все ошибки в выделенном диапазоне
</h3>
<p class="dscrptn">Поиск всех ошибок формул в выбранном диапазоне:</p>
<div class="error-types">
    <code>#Н/Д</code>
    <code>#ИМЯ?</code>
    <code>#ДЕЛ/0!</code>
    <code>#ССЫЛКА!</code>
    <code>#ЗНАЧ!</code>
    <code>#ЧИСЛО!</code>
    <code>#ПУСТО!</code>
</div>
<p>
    По клику на элемент в результатах поиска соответствующая ячейка будет выделена в рабочем листе.
</p>
<details class="more">
    <summary>Посмотреть скриншот</summary>
    <img src="images/FindErrorValues.png" alt="Подсвеченные ячейки с ошибками">
</details>

<h3 id="copyasmarkdown" class="zag">
    <img class="icons" alt="Иконка Копировать в Markdown" src="images/icons/markdown.png">
    Копировать в Markdown
</h3>
<p class="dscrptn">Копирование выбранных ячеек в буфер обмена в формате markdown-таблицы.</p>
<details class="more">
    <summary>Посмотреть скриншот</summary>
    <img src="images/ExportToMarkdown.png" alt="Пример экспорта в Markdown">
</details>

<h3 id="validatevalues" class="zag">
    <img class="icons" alt="Иконка Валидация значений" src="images/icons/validation.png">
    Валидация значений
</h3>
<p class="dscrptn">Проверка значений ячеек на соответствие определённым форматам:</p>
<ul>
    <li>✓ Число</li>
    <li>✓ Дата</li>
    <li>✓ ИНН физического лица (12 цифр с контрольными разрядами)</li>
    <li>✓ ИНН юридического лица (10 цифр с контрольным разрядом)</li>
    <li>✓ Текст для XML (без недопустимых символов вроде <code>&lt;</code> или <code>&gt;</code>)</li>
</ul>
<p class="note"><em>Примечание: Корректный формат ИНН не гарантирует существование организации или физического лица.</em></p>
<details class="more">
    <summary>Посмотреть скриншот</summary>
    <img src="images/Validate.png" alt="Результаты валидации">
</details>

<p class="back-to-top"><a href="#top">↑ Наверх</a></p>

<hr>

<h3 id="exporttosqlite" class="zag">
    <img class="icons" alt="Иконка Экспорт в SQLite" src="images/icons/validation.png">
    Экспорт в SQLite
</h3>
<p class="dscrptn">Экспорт всей книги в файл базы данных SQLite. Каждый лист становится отдельной таблицей с автоматическим определением типов столбцов.</p>
<ul>
    <li>Использовать первую строку как заголовки столбцов</li>
    <li>Пропускать начальные строки при необходимости</li>
    <li>Автоматическое определение типов данных</li>
</ul>
<details class="more">
    <summary>Посмотреть скриншоты</summary>
    <img src="images/ExportToSqlite1.png" alt="Диалог экспорта">
    <img src="images/ExportToSqlite2.png" alt="Результат в базе данных SQLite">
</details>

<p class="back-to-top"><a href="#top">↑ Наверх</a></p>

<hr>

<h3 id="createsamplexmlbasedonxsd" class="zag">
    <img class="icons" alt="Иконка Создать образец XML" src="images/icons/createSampleXml.png">
    Создать образец XML по XSD
</h3>
<p class="dscrptn">Генерация образца XML-файла из XSD-схемы для визуализации структуры.</p>

<details class="more">
    <summary>Посмотреть пример</summary>
    <p><strong>Входная XSD-схема:</strong></p>
    <pre>&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"&gt;
&lt;xs:element name="shiporder"&gt;
  &lt;xs:complexType&gt;
    &lt;xs:sequence&gt;
      &lt;xs:element name="orderperson" type="xs:string"/&gt;
      &lt;xs:element name="shipto"&gt;
        &lt;xs:complexType&gt;
          &lt;xs:sequence&gt;
            &lt;xs:element name="name" type="xs:string"/&gt;
            &lt;xs:element name="address" type="xs:string"/&gt;
            &lt;xs:element name="city" type="xs:string"/&gt;
            &lt;xs:element name="country" type="xs:string"/&gt;
          &lt;/xs:sequence&gt;
        &lt;/xs:complexType&gt;
      &lt;/xs:element&gt;
      &lt;xs:element name="item" maxOccurs="unbounded"&gt;
        &lt;xs:complexType&gt;
          &lt;xs:sequence&gt;
            &lt;xs:element name="title" type="xs:string"/&gt;
            &lt;xs:element name="note" type="xs:string" minOccurs="0"/&gt;
            &lt;xs:element name="quantity" type="xs:positiveInteger"/&gt;
            &lt;xs:element name="price" type="xs:decimal"/&gt;
          &lt;/xs:sequence&gt;
        &lt;/xs:complexType&gt;
      &lt;/xs:element&gt;
    &lt;/xs:sequence&gt;
    &lt;xs:attribute name="orderid" type="xs:string" use="required"/&gt;
  &lt;/xs:complexType&gt;
&lt;/xs:element&gt;
&lt;/xs:schema&gt;</pre>

    <p><strong>Сгенерированный XML:</strong></p>
    <pre>&lt;shiporder xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" orderid="orderid1"&gt;
  &lt;orderperson&gt;orderperson1&lt;/orderperson&gt;
  &lt;shipto&gt;
    &lt;name&gt;name1&lt;/name&gt;
    &lt;address&gt;address1&lt;/address&gt;
    &lt;city&gt;city1&lt;/city&gt;
    &lt;country&gt;country1&lt;/country&gt;
  &lt;/shipto&gt;
  &lt;item&gt;
    &lt;title&gt;title1&lt;/title&gt;
    &lt;note&gt;note1&lt;/note&gt;
    &lt;quantity&gt;1&lt;/quantity&gt;
    &lt;price&gt;1&lt;/price&gt;
  &lt;/item&gt;
  &lt;item&gt;
    &lt;title&gt;title2&lt;/title&gt;
    &lt;note&gt;note2&lt;/note&gt;
    &lt;quantity&gt;79228162514264337593543950335&lt;/quantity&gt;
    &lt;price&gt;-79228162514264337593543950335&lt;/price&gt;
  &lt;/item&gt;
  ...
&lt;/shiporder&gt;</pre>
</details>

<h3 id="validatexmlwithxsd" class="zag">
    <img class="icons" alt="Иконка Валидация XML" src="images/icons/validateXml.png">
    Валидация XML по XSD
</h3>
<p class="dscrptn">Валидация XML-файла по XSD-схеме. Подробный отчёт об ошибках будет создан в новой книге.</p>

<details class="more">
    <summary>Посмотреть пример отчёта об ошибках</summary>
    <div class="tbl">
        <table>
            <thead>
                <tr>
                    <th>Серьёзность</th>
                    <th>Элемент</th>
                    <th>Сообщение</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Ошибка</td>
                    <td>city</td>
                    <td>Элемент 'shipto' содержит недопустимый дочерний элемент 'city'. Ожидаемый список элементов: 'address'.</td>
                </tr>
                <tr>
                    <td>Ошибка</td>
                    <td>quantity</td>
                    <td>Элемент 'quantity' недопустим - значение '-5' недопустимо согласно типу данных 'http://www.w3.org/2001/XMLSchema:positiveInteger'</td>
                </tr>
                <tr>
                    <td>Ошибка</td>
                    <td>price</td>
                    <td>Элемент 'price' недопустим - значение 'asdasd' недопустимо согласно типу данных 'http://www.w3.org/2001/XMLSchema:decimal'</td>
                </tr>
            </tbody>
        </table>
    </div>
</details>

<p class="back-to-top"><a href="#top">↑ Наверх</a></p>

<hr>

<h3 id="undolastaction" class="zag">
    <img class="icons" alt="Иконка Отменить последнее действие" src="images/icons/undo.png">
    Отменить последнее действие
</h3>
<p class="dscrptn">Отмена последнего действия, выполненного с помощью этой надстройки. Доступно для некоторых функций в разделах «Преобразование значений» и «Форматирование значений», только если ячейки не были отредактированы с момента выполнения действия.</p>

<p class="back-to-top"><a href="#top">↑ Наверх</a></p>
